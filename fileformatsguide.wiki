= Introduction =

As is often the case, bioinformatics can be reduced to a battle between file formats. The following page collects their detail in as concise a manner as possible and so intends to serve as a reference guide.

== <code>.ped</code> ==

* Cols 1 to 6 (same as <code>.fam</code>) Family ID (FID) | Within-family ID (IID) | Father's IID | Mother's IID | Sex: 1 Male, 2 Female 3 Unk | 1 control, 2 Case, 0 or -9, Unknown.
* No headers
* Cols 7 onwards can be taken in pairs and represent the 2 base-pair identities of the genotypes
* The symbols <code>ACGT</code> have the usual meaning while <code>0</code> often denotes missing though <code>N</code> can also be used. plink allows this to be easily chanegd via the <code>--missing-genotype</code> option.
* Symbols for <code>I</code> and <code>D</code> also appear very small number quite often (less than 50) and these stand for Insertions and Deletions. It's not clear how other programs deal with this but probably they are set to missing as this seems like the safest (although data-poor) option.
* the index of each genotype correponds to a SNP whose names and coordinates are given in the <code>.map</code> file which is why these files are often paired together.

== <code>.map</code> file ==

* Just 4 columns: 1) CHRNUM 2) SNPNA 3) CMORGS 4) POS
* the SNP70 chip uses chromosome numbering as 1-31 as the equine autosomes, 32 as the X chromosome, Y as the male sex chromosome and no mitochrondrion.
* in plink (and - only perhaps though - related tools) this is <code>--chr-set 31 no-xy no-mt</code> with the <code>xy</code> probably referring to an artificial bipartitioning of the Y chromsome into homologous-with-X and a not-so partitions.
* However note that plink does prefer the Y chromosome to appear as <code>33</code> (i.e. 2 above the autosome number), and not as <code>Y</code>.

== <code>.fam</code> files ==

* no headers
* One of the 3 files generated via plink's <tt>--make-bed</tt> option
* 6 columns in total, actually the same as the <code>.ped</code> file's first six columns.
* Essentially an extraction of the <code>.ped</code> files first six columns.
* *# FID: Family ID 2) IID: Individual ID (aka. within Family ID) 3) Father's IID 4) Mother'#s IID 5) Sex, 1=M, 2=F, 0= Unk. 6) Single phenotype value or affectation or case/control designator.
* All in all, rather a pure pedigree-type file and essentially a list of sample names in Col 2 (IID).

== <code>.bim</code> files ==

* can be viewed as a slightly extended map file as its first 4 columns are identical, but it adds the two alleles in two extra columns bringing the column count to 6 instead of 4 as in the case of the map file.
* Just 6 columns: 1) CHRNUM 2) SNPNA 3) CMORGS 4) POS 5) A1 6) A2
* NOTE plink's documentation says the A1 allele is ''usually'' the minor (aka. alternative/mutant) allele.
* So, in VCF conversion, what is expected is that this should go in as ALT allele, and therefore be named second.
* It is one of the 3 files generated via plink's <code>--make-bed</code> option
* Its style approaches a <code>.vcf</code> file in that columns 5 and 6 give alleles, termed &quot;minor&quot; and &quot;major&quot; respectively

== <code>.tped</code> ==

* This is the transposed version of the <code>.ped</code>file.
* Transposed because SNPs are rows, and samples are pairs of columns (also VCF's general pattern).
* First four columns are: 1) CHROMNUM 2) SNPNAME 3) CENTIMORGANS 4) POSITION
* Must be accompanied by a <code>.tfam</code> file.
* As an aside it can be called as less famous than <code>.ped</code>, but more useful, aligning better with <code>.map</code> and <code>.vcf</code> files.
* Like <code>.ped</code> and <code>.map</code> files, it is also headerless.
* plink seems to output tped files with mere spaces, not tabs, between ''all'' the columns.

== <code>.tfam</code> files ==

* Actually the same as <code>.fam</code> files.

== <code>.bgl</code>, old beagle format ==

* this is not a widely reocgnised format, suhc as the other above. It's probably better described a table layout used by early version of beagle.

Note this format also needs an accompanying marker file with the positions of each SNP and in following format:

* 1) SNP name 2) position 3) Allele 1 of Reference 4) Allele 2 of Reference

The BGL format itself, which, as mentioned, though it seems to bear repeating, actually is not widely use at all is:

* First line prefixed with # for comment, then "sampleID", and then a tab-separated list of strings gving hte sampleID names.
* Second line prefixed with letter M, then SNPid name and then a tab separated list of alleles. So, every pair gives the GT and there should be as many pairs as sampleIDs.

== <code>.phe</code>, generated by GenABEL ==

This file is a product of the <code>export.plink()</code> function and is used to hold the <code>phdata</code> part of the gwaa.data structure. It is a typical table layout with headers and indices as row-names.

Whether a bug or a feature, when the above GenABEL function is used, an extra column appears in the table, perhaps a repeated FID column. Anyhow the one-to-one correspondance with the phdata breaks down and this must be fixed. The pipeline has such a fixing function.

== <code>.vcf</code> files ==

* A text file format that records the variants displayed by reads against the reference they are aligned to.
* An increasingly widely used format for recording genotypes.
* It denotes a reference allele (which, in contrast to plink convention, is named first and sample names then record a 0 to correspond to it, or 1 to correspond to the ALT alternate allele.
* Despite this, VCF apparently does not conserve or attempt to pin down this order.
* The sample's genotypes are separated by a forward slash if genotypes are unphased. If the symbol is a pipe or bar "|", this implies the data is phased.

Example:

 #CHROM POS ID REF ALT QUAL FILTER INFO FORMAT NA00001 NA00002 NA00003
 20 14370 rs6054257 G A 29 PASS NS=3;DP=14;AF=0.5;DB;H2 GT:GQ:DP:HQ 0|0:48:1:51,51 1|0:48:8:51,51 1/1:43:5:.,.
 20 17330 . T A 3 q10 NS=3;DP=11;AF=0.017 GT:GQ:DP:HQ 0|0:49:3:58,50 0|1:3:5:65,3 0/0:41:3
 20 1110696 rs6040355 A G,T 67 PASS NS=2;DP=10;AF=0.333,0.667;AA=T;DB GT:GQ:DP:HQ 1|2:21:6:23,27 2|1:2:0:18,2 2/2:35:4
 20 1230237 . T . 47 PASS NS=3;DP=13;AA=T GT:GQ:DP:HQ 0|0:54:7:56,60 0|0:48:4:51,51 0/0:61:2
 20 1234567 microsat1 GTC G,GTCT 50 PASS NS=3;DP=9;AA=G GT:GQ:DP 0/1:35:4 0/2:17:2 1/1:40:3</pre>

* Allows multiple sample information by having one column per sample and a variable number of columns.
* Records a <code>REF</code> base call and a <code>ALT</code> base call in columns 4 and 5, this is for an implicit reference sample.
* Samples' genotypes are identified relative to this: <code>0</code> implies sample identical to reference base call, <code>1</code> implies identicial to <code>ALT</code> base call.
* The variable number of columns are kept track of in the headers at the top of the file which give detailed metadata on what info the columns contain.
* There is also a general header giving the column names
* The first seven columns are generally fixed in nature: <code>CHROM</code>, <code>POS</code>, <code>ID</code>, <code>REF</code>, <code>ALT</code>, <code>QUAL</code> and <code>FILTER</code> and refer to the nature of the variant from a reference point of view.
* The last two columns, headed INFO and FORMAT are also allowed have subcolumns: the colon symbol is used to separate these subcolumns
* The subcolumns in INFO and FORMAT are also variable. INFO is extra information on the variant, and FORMAT gives the information held in the subsequent sample columns.
* The columns referring to the samples (of which, one each) are headed (labelled) by the sample name and the FORMAT column gives the labels for the subcolumns held in each sample column.

''Important'': A dot appearing in a subcolumn represents missing information.

* '''BCF''' is simply the binary (and therefore compressed) version of the file format.

This is a format that used to be maintained by the 1000 Genomes Project. The latest version 4.2 and its specification is now hosted at the samtools website.

=== Common FORMAT subcolumns ===

It's worth re-iterating that all these are per-sample attributes and values.

* <code>GT</code>: Genotype for the sample at that variant position. Possibly the most important piece of data for the sample. For a SNP this will give &quot;0/0&quot; for homogeneous on the Ref (i.e. the sample is not variant for this position), &quot;1/0&quot; and &quot;0/1&quot; for heterogeneity. &quot;1/1&quot; is homogeneity on the Alt, i.e. the alternative, the Variant SNP.
* <code>DP</code> refer to overall depth at the locus/position without taking into account base quality
* <code>DP4</code> refers to 4 depth readings separated by semicolons. In contrast to DP, these are filtered for base quality. The first pair refer to the depth of reads conforming to reference allele, first on the forward strand, second on the reverse stand. The second pair refer to the alternate allele depth. Again, forward strand coming first and reverse coming second. A simple example is shown here

=== Allele Frequencies ===

Please look at the following GATK forum link for instructions on how to do this.

= Other file formats of interest =

== 23andme SNPs ==

* Four columns, 1) string, the id (or, rsid) 2) chromosome desig 3) position 4) two letters, the GT
* Note that the ancestry raw file will have a tab between the GT alleles.

= Links =

* Plink's listing: https://www.cog-genomics.org/plink2/formats
